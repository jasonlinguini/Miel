<canvas id="gameCanvas"></canvas>

<script>
// === CONFIGURATION ===
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// === IMAGES ===
const hive = new Image();
hive.src = "719AC91B-EB0C-40B6-88AA-254CEA3F46CD.png";

const bee = new Image();
bee.src = "https://upload.wikimedia.org/wikipedia/commons/4/47/Honeybee.png";

const wasp = new Image();
wasp.src = "https://upload.wikimedia.org/wikipedia/commons/d/d8/Wasps.png";

const goldHoney = new Image();
goldHoney.src = "https://upload.wikimedia.org/wikipedia/commons/3/3a/Honey_jar.png";

// === VARIABLES DE JEU ===
let entities = [];
let score = 0;
let combo = 1;
let running = false;
let gameTime = 60; // secondes

// === AJOUT D'ENTITÉS ===
function spawnEntity() {
    const type = Math.random();
    let entity = {
        x: canvas.width / 2 - 50,
        y: canvas.height / 2,
        size: 50,
        dx: (Math.random() - 0.5) * 4,
        dy: (Math.random() - 0.5) * 4,
    };

    if (type < 0.7) {
        entity.img = bee;
        entity.points = 10;
        entity.type = "bee";
    } else if (type < 0.9) {
        entity.img = wasp;
        entity.points = -10;
        entity.type = "wasp";
    } else {
        entity.img = goldHoney;
        entity.points = 50;
        entity.type = "bonus";
    }
    entities.push(entity);
}

// === AFFICHER LE TEXTE DE SCORE ===
function drawHUD() {
    ctx.fillStyle = "white";
    ctx.font = "20px Arial";
    ctx.fillText(`Score: ${score}`, 20, 30);
    ctx.fillText(`Temps: ${gameTime}s`, 20, 60);
}

// === BOUCLE DE JEU ===
function gameLoop() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Ruche au centre
    const hiveWidth = 500;
    const hiveHeight = 300;
    const hiveX = canvas.width / 2 - hiveWidth / 2;
    const hiveY = canvas.height / 2 - hiveHeight / 2;
    ctx.drawImage(hive, hiveX, hiveY, hiveWidth, hiveHeight);

    // Mise à jour et affichage des entités
    entities.forEach((e, i) => {
        e.x += e.dx;
        e.y += e.dy;
        ctx.drawImage(e.img, e.x, e.y, e.size, e.size);

        // Suppression si hors écran
        if (e.x < -50 || e.x > canvas.width + 50 || e.y < -50 || e.y > canvas.height + 50) {
            entities.splice(i, 1);
        }
    });

    drawHUD();

    if (running) requestAnimationFrame(gameLoop);
}

// === GESTION DES CLICS ===
canvas.addEventListener("click", (e) => {
    const clickX = e.clientX;
    const clickY = e.clientY;

    entities.forEach((entity, i) => {
        if (
            clickX >= entity.x &&
            clickX <= entity.x + entity.size &&
            clickY >= entity.y &&
            clickY <= entity.y + entity.size
        ) {
            score += entity.points;
            if (entity.type === "bonus") {
                combo *= 2;
                alert("✨ Miel doré : points x2 !");
            } else if (entity.type === "wasp") {
                alert("Aïe ! Guêpe un peu susceptible 🐝");
            }
            entities.splice(i, 1);
        }
    });
});

// === LANCER LE JEU ===
function startGame() {
    score = 0;
    combo = 1;
    gameTime = 60;
    entities = [];
    running = true;
    setInterval(() => {
        if (running) spawnEntity();
    }, 800);
    setInterval(() => {
        if (running) {
            gameTime--;
            if (gameTime <= 0) {
                running = false;
                alert(`Fin de partie ! Score final : ${score}`);
            }
        }
    }, 1000);
    gameLoop();
}

startGame();
</script>
